# How to contribute to the OpenSwitch Project Code

Follow the [Getting Started](./getting-started.html) guide to prepare your system to be able to contribute to the OpenSwitch project.

## Contents
- [Contributing changes to OpenSwitch](#contributing-changes-to-openswitch)
	- [Working behind a firewall](#working-behind-a-firewall)
	- [Preparing changes to be reviewed](#preparing-changes-to-be-reviewed)
	- [Sending changes for review](#sending-changes-for-review)
	- [Resubmitting a set of changes](#resubmitting-a-set-of-changes)
- [OpenSwitch Coding Style](#openswitch-coding-style)
	- [Comparisons](#comparisons)
	- [Variables](#variables)

## Contributing changes to OpenSwitch
Changes to the OpenSwitch code base go through a review process before being merged. This page describes how local modifications can be submitted for review and, if approved, made available upstream in the OpenSwitch project.

### Preparing changes to be reviewed
Before attempting to commit changes, make sure that they are compliant with the [OpenSwitch Coding Style](#openswitch-coding-style). For non-OpenSwitch modules, follow the coding style that the module already uses.

In particular,  the following files be rejected:
* Files with trailing spaces
* Files with with non-printable ASCII characters in their names.

Changes for review should be **committed to a local branch** with a commit message that:
* Begin with a single line of text which summarizes the contents of the change.
* Additionally provide a description following the summarization line.

If the change set has been composed by multiple commits to the local branch, **consider squashing them into a single commit** using `git rebase`.

### Sending changes for review
`git-review` is used as an aid when submitting a change set for review.  
The commit message for the set of changes must include a `Change-Id`, as generated by the `-i` option to `git-review`. To send changes for review, commit the changes and then run git-review as follows:
```bash
$ git-review -i
$ git commit -s -m "Meaningful summary of this change set."
```

### Resubmitting a set of changes
Reviewers may request modifications to the set of changes previously submitted. Make the changes as requested by the reviewers and then submit a patch with the following commands. The `-i` switch for `git-review` is not needed as a `Change-Id` was previously generated.
```bash
$ git commit --amend -s -m "Meaningful summary of this change set."
$ git-review
```
It is also possible to abandon a set of changes using the web interface, if that is desired.

## OpenSwitch Coding Style
The coding style used for OpenSwitch is an extension of the [Open vSwitch Coding Style](https://github.com/openvswitch/ovs/blob/master/CodingStyle.md), which is itself an extension of the [One True Brace Style](https://en.wikipedia.org/wiki/Indent_style#Variant:_1TBS) for indenting. The additions below are clarifications and do not conflict with the Open vSwitch style.

### Comparisons
Write comparisons in a form that reads naturally. Examples:
```c
 bool foo_b = some_bool_function(x);
int foo_i = some_int_function(x);

if (true == foo_b)   /* No, unnecessary comparison and doesn't read well */
if (foo_b)           /* Yes */

if (11 == foo_i)     /* No, doesn't read well */
if (foo_i == 11)     /* Yes */

if (foo_i == 0)      /* Yes */
if (!foo_i)          /* Yes */
```

### Variables
Do not do gratuitous initialization of variables.  Doing this prevents the compiler from detecting accidental use before initialization.

```c
struct Goofus *goofus = NULL;   /* Wrong */
struct Gallant *gallant;        /* Right */
```
